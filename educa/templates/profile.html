{% extends "dashboard.html" %}
{% block content_dash %}
  <div class="course-title border-bottom">
    <h2>Profile</h2>
  </div>
  <div class="profile-content">
    <div class="container">
      {% if edit %}
        <form action="" method="POST" enctype="multipart/form-data" novalidate>
          {{ form.hidden_tag() }}
          <div class="row pb-1">
            <div class="col-6 col-md-4 d-flex justify-content-end my-2">
              <img class="profile-img mx-5" src="{{ profile_image }}" alt="">
            </div>
            <div class="col-6 col-md-4 d-flex flex-column align-items-start my-4">

                {% if form.fullname.errors %}
                  {{ form.fullname(class="form-control is-invalid my-1", placeholder="Fullname") }}
                  <div class="invalid-feedback">
                    {% for error in form.fullname.errors %}
                      <small>{{ error }}</small>
                    {% endfor %}
                  </div>
                {% else %}
                  {{ form.fullname(class="form-control my-1", placeholder="Fullname") }}
                {% endif %}

                {% if form.email.errors %}
                  {{ form.email(class="form-control is-invalid my-1", placeholder="Email") }}
                  <div class="invalid-feedback">
                    {% for error in form.email.errors %}
                      <small>{{ error }}</small>
                    {% endfor %}
                  </div>
                {% else %}
                  {{ form.email(class="form-control my-1", placeholder="Email") }}
                {% endif %}

            </div>
            <div class="col-md-4 d-none d-md-flex flex-column align-items-center my-4">
              <div class="d-flex justify-content-center align-items-center mb-2">
                {{ form.removepic(class="mr-2 mb-2") }}
                {{ form.removepic.label }}
              </div>

              {% if form.picture.errors %}
                <p class="mb-1">Update Profile Picture</p>
                <button class="btn btn-sm btn-outline-purple" type="button">{{ form.picture.label(class="p-0 m-0 cursor-pointer") }}</button>
                {{ form.picture(class="d-none") }}
                {% for error in form.picture.errors %}
                  <small class="text-danger">{{ error }}</small>
                {% endfor %}
              {% else %}
                <p class="mb-1">Update Profile Picture</p>
                <button class="btn btn-sm btn-outline-purple" type="button">{{ form.picture.label(class="p-0 m-0 cursor-pointer") }}</button>
                {{ form.picture(class="d-none") }}
              {% endif %}
            </div>
          </div>
          <div class="row">

            <div class="col-12 bio-pad my-3">
              {% if form.biography.errors %}
                {{ form.biography(class="form-control is-invalid", placeholder="Biography") }}
                <div class="invalid-feedback">
                  {% for error in form.biography.errors %}
                    <small>{{ error }}</small>
                  {% endfor %}
                </div>
              {% else %}
                {{ form.biography(class="form-control bio-size", placeholder="Biography") }}
              {% endif %}
            </div>

            <div class="col-md-12 d-flex flex-column align-items-center mb-3">
              <div class="d-flex d-md-none flex-column align-items-center">
                <div class="d-flex justify-content-center align-items-center mb-2">
                  {{ form.removepic(class="mr-2 mb-2") }}
                  {{ form.removepic.label }}
                </div>

                {% if form.picture.errors %}
                  <p class="mb-1">Update Profile Picture</p>
                  <button class="btn btn-sm btn-outline-purple" type="button">{{ form.picture.label(class="p-0 m-0") }}</button>
                  {{ form.picture(class="d-none") }}
                  {% for error in form.picture.errors %}
                    <small class="text-danger">{{ error }}</small>
                  {% endfor %}
                {% else %}
                  <p class="mb-1">Update Profile Picture</p>
                  <button class="btn btn-sm btn-outline-purple" type="button">{{ form.picture.label(class="p-0 m-0 cursor-pointer") }}</button>
                  {{ form.picture(class="d-none") }}
                {% endif %}
              </div>

              {{ form.submit(class="btn btn-outline-primary mt-4 mb-3") }}

            </div>
          </div>
        </form>
      {% else %}
        <div class="row pb-1">
          <div class="col-6 col-md-4 d-flex justify-content-end my-2">
            <img class="profile-img mx-5" src="{{ profile_image }}" alt="">
          </div>
          <div class="col-6 col-md-4 d-flex flex-column align-items-start my-4">
              <h6 class="my-1">{{ current_user.first_name }} {{ current_user.last_name }}</h6>
              <p class="my-1">{{ current_user.email }}</p>
          </div>
          <div class="col-md-4 d-none d-md-flex flex-column align-items-center my-5">
            <form action="" method="GET">
              <button class="btn btn-outline-primary" type="submit" name="edit" value="true"><i class="far fa-edit"></i> Edit Profile</button>
            </form>
            <a class="btn btn-outline-warning mt-3" href="{{ url_for('logout') }}">Logout</a>
          </div>
        </div>
        <div class="row">
          <div class="col-12 bio-pad mb-3">
            {{ current_user.biography }}
          </div>
          <div class="col-md-12 d-flex d-md-none flex-column align-items-center mt-2 mb-5">
            <form action="" method="GET">
              <button class="btn btn-outline-primary" type="submit" name="edit" value="true"><i class="far fa-edit"></i> Edit Profile</button>
            </form>
            <a class="btn btn-outline-primary mt-3" href="{{ url_for('logout') }}">Logout</a>
          </div>
        </div>
      {% endif %}

      <div class="row">
        <div id="assignments" class="col-6 student-info student-info-tab student-info-selected">
          <h6 class="my-3"><i class="far fa-folder-open"></i> Assignments</h6>
        </div>
        <div id="courses" class="col-6 student-info student-info-tab">
          <h6 class="my-3"><i class="far fa-bell"></i> Courses</h6>
        </div>
      </div>
      {% if current_user.profession == "Student" %}
        <!-- Assignments -->
        <div id="assignments_list" class="">
          {% for assignment in assignments %}
            <div class="row border-bottom">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ assignment.assignment.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Courses -->
        <div id="courses_list" class="d-none">
          {% for course in courses %}
            <div class="row border-bottom">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ course.course.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>
      {% elif current_user.profession == "Teacher" %}
        <!-- Assignments -->
        <div id="assignments_list" class="">
          {% for i in range(assignments| length) %}
            {% for assignment in assignments[i] %}
              <div class="row border-bottom">
                <div class="col-12 d-flex align-items-center student-info">
                  <h6 class="m-3">{{ assignment.title }}</h6>
                </div>
              </div>
            {% endfor %}
          {% endfor %}
        </div>

        <!-- Courses -->
        <div id="courses_list" class="d-none">
          {% for course in courses %}
            <div class="row border-bottom">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ course.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>
  <script type="text/javascript" src="{{ url_for('static', filename='js/profile.js')|autoversion }}"></script>
{% endblock content_dash %}

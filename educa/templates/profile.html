{% extends "dashboard.html" %}
{% block content_dash %}
  <div class="dashboard-header">
    <h2>Profile</h2>
  </div>
  <div class="profile-content">
    <div class="container">

      {% if edit %}

        <form action="" method="POST" enctype="multipart/form-data" novalidate>
          {{ form.hidden_tag() }}
          <div class="row pb-1">
            <div class="col-6 col-md-4 d-flex justify-content-end my-2">
                <div class="profile-img" style="background-image: url({{ profile_image }});"></div>
            </div>
            <div class="col-6 col-md-4 d-flex flex-column align-items-start my-4">

                {% if form.fullname.errors %}
                  {{ form.fullname(class="form-control is-invalid my-1", placeholder="Fullname") }}
                  <div class="invalid-feedback">
                    {% for error in form.fullname.errors %}
                      <small>{{ error }}</small>
                    {% endfor %}
                  </div>
                {% else %}
                  {{ form.fullname(class="form-control my-1", placeholder="Fullname") }}
                {% endif %}

                {% if form.email.errors %}
                  {{ form.email(class="form-control is-invalid my-1", placeholder="Email") }}
                  <div class="invalid-feedback">
                    {% for error in form.email.errors %}
                      <small>{{ error }}</small>
                    {% endfor %}
                  </div>
                {% else %}
                  {{ form.email(class="form-control my-1", placeholder="Email") }}
                {% endif %}

            </div>
            <div class="col-md-4 d-none d-md-flex flex-column align-items-center my-4">
              <div class="d-flex justify-content-center align-items-center mb-2">
                {{ form.removepic(class="mr-2 mb-2") }}
                {{ form.removepic.label }}
              </div>

              {% if form.picture.errors %}
                <p class="mb-1">Update Profile Picture</p>
                <button class="btn btn-sm btn-blue mt-2" type="button">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-upload" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z"/>
                    <path d="M7 18a4.6 4.4 0 0 1 0 -9h0a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1" />
                    <polyline points="9 15 12 12 15 15" />
                    <line x1="12" y1="12" x2="12" y2="21" />
                  </svg>
                  {{ form.picture.label(class="p-0 m-0 cursor-pointer") }}
                </button>
                {{ form.picture(class="d-none") }}
                {% for error in form.picture.errors %}
                  <small class="text-danger">{{ error }}</small>
                {% endfor %}
              {% else %}
                <p class="mb-1">Update Profile Picture</p>
                <button class="btn btn-sm btn-blue mt-2" type="button">
                  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-upload" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                    <path stroke="none" d="M0 0h24v24H0z"/>
                    <path d="M7 18a4.6 4.4 0 0 1 0 -9h0a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1" />
                    <polyline points="9 15 12 12 15 15" />
                    <line x1="12" y1="12" x2="12" y2="21" />
                  </svg>
                  {{ form.picture.label(class="p-0 m-0 cursor-pointer") }}
                </button>
                {{ form.picture(class="d-none") }}
              {% endif %}
            </div>
          </div>
          <div class="row">

            <div class="col-12 bio-pad my-3">
              {% if form.biography.errors %}
                {{ form.biography(class="form-control is-invalid", placeholder="Biography") }}
                <div class="invalid-feedback">
                  {% for error in form.biography.errors %}
                    <small>{{ error }}</small>
                  {% endfor %}
                </div>
              {% else %}
                {{ form.biography(class="form-control bio-size", placeholder="Biography") }}
              {% endif %}
            </div>

            <div class="col-md-12 d-flex flex-column align-items-center mb-3">
              <div class="d-flex d-md-none flex-column align-items-center">
                <div class="d-flex justify-content-center align-items-center mb-2">
                  {{ form.removepic(class="mr-2 mb-2") }}
                  {{ form.removepic.label }}
                </div>

                {% if form.picture.errors %}
                  <p class="mb-1">Update Profile Picture</p>
                  <button class="btn btn-sm btn-blue mt-2" type="button">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-upload" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z"/>
                      <path d="M7 18a4.6 4.4 0 0 1 0 -9h0a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1" />
                      <polyline points="9 15 12 12 15 15" />
                      <line x1="12" y1="12" x2="12" y2="21" />
                    </svg>
                    {{ form.picture.label(class="p-0 m-0") }}
                  </button>
                  {{ form.picture(class="d-none") }}
                  {% for error in form.picture.errors %}
                    <small class="text-danger">{{ error }}</small>
                  {% endfor %}
                {% else %}
                  <p class="mb-1">Update Profile Picture</p>
                  <button class="btn btn-sm btn-blue mt-2" type="button">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-upload" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                      <path stroke="none" d="M0 0h24v24H0z"/>
                      <path d="M7 18a4.6 4.4 0 0 1 0 -9h0a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7h-1" />
                      <polyline points="9 15 12 12 15 15" />
                      <line x1="12" y1="12" x2="12" y2="21" />
                    </svg>
                    {{ form.picture.label(class="p-0 m-0 cursor-pointer") }}
                  </button>
                  {{ form.picture(class="d-none") }}
                {% endif %}
              </div>

              {{ form.submit(class="btn btn-blue mt-4 mb-3") }}

            </div>
          </div>
        </form>

      {% else %}

        <div class="row pb-1">
          <div class="col-6 col-md-4 d-flex justify-content-end my-2">
              <div class="profile-img" style="background-image: url({{ profile_image }});"></div>
          </div>
          <div class="col-6 col-md-4 d-flex flex-column align-items-start my-4">
              <h6 class="my-1">{{ current_user.first_name }} {{ current_user.last_name }}</h6>
              <p class="my-1">{{ current_user.email }}</p>
          </div>
          <div class="col-md-4 d-none d-md-flex flex-column align-items-center my-5">
            <form action="" method="GET">
              <button class="btn btn-blue" type="submit" name="edit" value="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z"/>
                  <path d="M9 7 h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3" />
                  <path d="M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3" />
                  <line x1="16" y1="5" x2="19" y2="8" />
                </svg>
                Edit Profile
              </button>
            </form>
            <a class="btn btn-yellow mt-3" href="{{ url_for('logout') }}">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 2 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
              Logout
            </a>
          </div>
        </div>
        <div class="row">
          <div class="col-12 d-flex justify-content-center bio-pad mb-3">
            {{ current_user.biography }}
          </div>
          <div class="col-md-12 d-flex d-md-none flex-column align-items-center mt-2 mb-5">
            <form action="" method="GET">
              <button class="btn btn-blue" type="submit" name="edit" value="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-edit" width="1em" height="1em" viewBox="0 2 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
                  <path stroke="none" d="M0 0h24v24H0z"/>
                  <path d="M9 7 h-3a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-3" />
                  <path d="M9 15h3l8.5 -8.5a1.5 1.5 0 0 0 -3 -3l-8.5 8.5v3" />
                  <line x1="16" y1="5" x2="19" y2="8" />
                </svg>
                Edit Profile
              </button>
            </form>
            <a class="btn btn-yellow mt-3" href="{{ url_for('logout') }}">
              <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 2 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-log-out"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
              Logout
            </a>
          </div>
        </div>
      {% endif %}

      <div class="row">
        <div id="assignments" class="col-6 student-info student-info-tab student-info-selected">
          <h6 class="my-3">
            <svg height="1em" width="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 60 576 512"><path class="icons" d="M527.9 224H480v-48c0-26.5-21.5-48-48-48H272l-64-64H48C21.5 64 0 85.5 0 112v288c0 26.5 21.5 48 48 48h400c16.5 0 31.9-8.5 40.7-22.6l79.9-128c20-31.9-3-73.4-40.7-73.4zM48 118c0-3.3 2.7-6 6-6h134.1l64 64H426c3.3 0 6 2.7 6 6v42H152c-16.8 0-32.4 8.8-41.1 23.2L48 351.4zm400 282H72l77.2-128H528z"/></svg>
            Assignments
           </h6>
        </div>
        <div id="courses" class="col-6 student-info student-info-tab">
          <h6 class="my-3">
            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 3 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-book-open icons-vis"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
            Courses
          </h6>
        </div>
      </div>
      {% if current_user.profession == "Student" %}
        <!-- Assignments -->
        <div id="assignments_list" class="">
          {% for assignment in assignments %}
            <div class="row border-bottom-green">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ assignment.assignment.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>

        <!-- Courses -->
        <div id="courses_list" class="d-none">
          {% for course in courses %}
            <div class="row border-bottom-green">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ course.course.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>
      {% elif current_user.profession == "Teacher" %}
        <!-- Assignments -->
        <div id="assignments_list" class="">
          {% for i in range(assignments| length) %}
            {% for assignment in assignments[i] %}
              <div class="row border-bottom-green">
                <div class="col-12 d-flex align-items-center student-info">
                  <h6 class="m-3">{{ assignment.title }}</h6>
                </div>
              </div>
            {% endfor %}
          {% endfor %}
        </div>

        <!-- Courses -->
        <div id="courses_list" class="d-none">
          {% for course in courses %}
            <div class="row border-bottom-green">
              <div class="col-12 d-flex align-items-center student-info">
                <h6 class="m-3">{{ course.title }}</h6>
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>
  <script type="text/javascript" src="{{ url_for('static', filename='js/profile.js')|autoversion }}"></script>
{% endblock content_dash %}
